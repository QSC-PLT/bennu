define(["parse/parse","stream/stream"],function(e,k){var l=Array.prototype.map,m=Array.prototype.reduce,f=RegExp.prototype.test,n=function(a,b){return a.valueOf()===b.valueOf()},c=function(a,b){return function(i,d,f,c,g,h){c=i.pos;return(g=i.input)?(g=k.first(g),a(g)?f(g,i.next(g),d):h(new e.ExpectError(c,b+' Found: "'+g+'"'),i,d)):h(new e.UnexpectError(c,"end of input"),i,d)}},h=function(a){return c(n.bind(void 0,a),'"'+a+'"')},p=function(a,b){return e.next(b,a)},q=function(a,b){return a[b]=a[b]||
{}},r=function(a,b){m.call(b,q,a)[""]=null;return a},j=function(a,b){var c=[];Object.keys(a).forEach(function(d){d=a[d];1===d.length&&c.push(e.attempt(e.next(h(d),j(a[d],b+d))))});a.hasOwnProperty("")&&c.push(e.always(b));return e.choice.apply(void 0,c)},s=c(f.bind(/^.$/),"any character"),t=c(f.bind(/^[a-z]$/i),"any letter character"),u=c(f.bind(/^\s$/i),"any space character"),f=c(f.bind(/^[0-9]$/i),"any digit character");return{character:h,string:function(a){return l.call(a,h).reduceRight(p,e.always(a))},
trie:function(a){return j(a.reduce(r,{}),"")},anyChar:s,letter:t,space:u,digit:f}});
