define(["parse/parse","nu/stream"],function(b){var k=Array.prototype.reduce,c=RegExp.prototype.test,g=function(a,b){return a.valueOf()===b.valueOf()},e=function(a){return function(d,f){return new b.ExpectError(d,a,f)}},h=function(a){return b.token(g.bind(void 0,a),e(a))},i=function(a,d,f){return 0===d.length?b.always(a):b.bind(b.token(g.bind(void 0,d[0]),function(d,c){return new b.ExpectError(d,a,f+c)}),function(b){return i(a,d.slice(1),f+b)})},l=function(a,b){return a[b]=a[b]||{}},m=function(a,b){k.call(b,
l,a)[""]=null;return a},j=function(a,d){var c=[];Object.keys(a).forEach(function(e){1===e.length&&c.push(b.next(h(e),j(a[e],d+e)))});a.hasOwnProperty("")&&c.push(b.always(d));return b.choice.apply(void 0,c)},n=b.token(c.bind(/^.$/),e("any character")),p=b.token(c.bind(/^[a-z]$/i),e("any letter character")),q=b.token(c.bind(/^\s$/i),e("any space character")),c=b.token(c.bind(/^[0-9]$/i),e("any digit character"));return{character:h,string:function(a){return b.attempt(i(a,a,""))},trie:function(a){return b.attempt(j(a.reduce(m,
{}),""))},anyChar:n,letter:p,space:q,digit:c}});
