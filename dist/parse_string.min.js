define(["parse/parse","nu/stream"],function(a){var h=Function.prototype.call.bind(Array.prototype.reduce),b=RegExp.prototype.test,i=function(a,d){return a.valueOf()===d.valueOf()},e=function(b){return function(d,c){return new a.ExpectError(d,b,null===c?"end of input":c)}},j=function(b){return a.token(i.bind(void 0,b),e(b))},k=function d(c,b,g,f){return 0===b.length?a.always(c):a.next(a.token(i.bind(void 0,b[0]),function(b,d){return new a.ExpectError(f,c,null===d?g:g+d)}),d(c,b.slice(1),g+b[0],f))},
l=function(a,c){a[c]=a[c]||{};return a[c]},m=function(a,c){h(c,l,a)[""]=null;return a},n=function c(b,g){return a.choice.apply(void 0,Object.keys(b).map(function(f){return 0===f.length?a.always(g):a.next(j(f),c(b[f],g+f))}))},p=a.Parser("Any Character",a.token(b.bind(/^.$/),e("any character"))),q=a.Parser("Any Letter",a.token(b.bind(/^[a-z]$/i),e("any letter character"))),r=a.Parser("Any Whitespace",a.token(b.bind(/^\s$/i),e("any space character"))),b=a.Parser("Any Digit",a.token(b.bind(/^[0-9]$/i),
e("any digit character")));return{character:j,string:function(b){return a.bind(a.getPosition(),function(e){return a.attempt(k(b,b,"",e))})},trie:function(b){return a.attempt(n(h(b,m,{}),""))},anyChar:p,letter:q,space:r,digit:b}});
