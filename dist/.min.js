define(["parse/parse","stream/stream"],function(e,k){var l=Array.prototype.map,m=Array.prototype.reduce,b=RegExp.prototype.test,n=function(a,c){return a.valueOf()===c.valueOf()},d=function(a,c){return function(h,i,b,d,f,g){d=h.pos;return(f=h.input)?(f=k.first(f),a(f)?b(f,h.next(f),i):g(new e.ExpectError(d,c+' Found: "'+f+'"'),h,i)):g(new e.UnexpectError(d,"end of input"),h,i)}},g=function(a){return d(n.bind(void 0,a),'"'+a+'"')},p=function(a,c){return e.next(c,a)},q=function(a,c){return a[c]=a[c]||
{}},r=function(a,c){m.call(c,q,a)[""]=null;return a},j=function(a,c){var d=[];Object.keys(a).forEach(function(b){1===b.length&&d.push(e.attempt(e.next(g(b),j(a[b],c+b))))});a.hasOwnProperty("")&&d.push(e.always(c));return e.choice.apply(void 0,d)},s=d(b.bind(/^.$/),"any character"),t=d(b.bind(/^[a-z]$/i),"any letter character"),u=d(b.bind(/^\s$/i),"any space character"),b=d(b.bind(/^[0-9]$/i),"any digit character");return{character:g,string:function(a){return l.call(a,g).reduceRight(p,e.always(a))},
trie:function(a){return j(a.reduce(r,{}),"")},anyChar:s,letter:t,space:u,digit:b}});
